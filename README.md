# Binance 자동화 암호화폐 트레이딩 봇

[in english](./README_en.md)

이 프로젝트는 Binance에서 제공하는 Spot 및 Earn API를 활용하여 비트코인 거래를 자동으로 실행하는 트레이딩 봇입니다. 이 봇은 여러 가지 투자 전략을 바탕으로 실시간 데이터를 수집하고 분석하여 매수 및 매도 주문을 자동으로 발행합니다. 이를 통해 수익성 있는 거래 기회를 지속적으로 포착하며 Earn 이자 수익을 극대화합니다.

## 주요 기능

- **데이터 수집 및 분석**: Binance의 WebSocket 스트림을 통해 실시간 가격, RSI(상대 강도 지수), 거래량 및 USDT APR 데이터를 수집합니다. 오류 발생 시 REST API를 활용하여 데이터를 백업합니다.
- **멀티 스레드 구조**: 각 기능(데이터 수집, 데이터 모니터링, 주문 실행, WebSocket 연결)을 독립적인 스레드로 실행하여 실시간으로 데이터를 수집하고 주문을 실행합니다.
- **투자 전략**: APR, 가격 하락, RSI 임계값에 기반한 매수/매도 전략을 구현하였습니다. 예를 들어, 최근 24시간 동안 비트코인 가격이 5% 이상 하락하면 매수를, RSI가 90 이상일 때 매도를 발행하는 식입니다.
- **Earn 관리**: Earn 월렛에 있는 USDT를 자동으로 Flexible Saving에 구독하며, Earn 지갑과 Spot 지갑 간 전송 기능을 지원하여 유동성 관리를 자동화합니다.
- **주문 관리**: 매수/매도 주문 발행 후, 체결 여부를 지속적으로 모니터링하고, 체결되지 않은 주문은 일정 시간 후 취소 및 재발행합니다.

## 설치 방법

1. 필요한 라이브러리 설치:

```
pip install pandas requests websocket-client pandas-ta
```

1. **API Key 설정**:
    - `API_KEY`와 `API_SECRET`를 Binance 계정에서 발급받아 코드 내에 입력합니다.
2. **프로그램 실행**:

```
python btc_usdt_apr_strategy.py
```

## 사용된 API

- **WebSocket 스트림**: 실시간 가격, 거래량, RSI 및 APR 데이터를 수집.
- **Market Data REST API**: 시장 데이터 백업 및 보조 지표 계산.
- **Spot Trading API**: 매수/매도 주문 발행 및 주문 관리.
- **Earn API**: USDT Flexible Saving 구독 및 환매 관리.
- **Wallet API**: 지갑 잔액 조회 및 Earn-Spot 간 자금 이동.

## 전역 변수 설명

- `last_5_percent_buy_time`, `last_10_percent_buy_time`, `last_50_percent_buy_time`: 각각 5%, 10%, 50% 하락 이후 매수 주문이 체결된 시간을 기록하여 동일 조건의 주문이 24시간 내 재발동하지 않도록 제어합니다.
- **데이터 큐**: 가격, RSI, 거래량, APR 데이터를 스레드 간에 공유하고 처리할 수 있도록 큐를 사용합니다.
- **주문 큐**: 조건이 만족되었을 때 매수/매도 주문 정보를 담아 주문 실행 스레드가 처리하도록 합니다.

## 실행 흐름

1. **데이터 수집**: WebSocket을 통해 실시간 데이터를 큐에 쌓습니다.
2. **데이터 모니터링**: 각종 투자 조건을 만족하는지를 판단하여 주문 큐에 주문 데이터를 넣습니다.
3. **주문 실행**: 주문 큐에서 주문을 꺼내어 Binance API를 통해 매수/매도 주문을 실행하고 체결 여부를 모니터링합니다.
4. **Earn 관리**: 주문 체결 후 Earn 월렛으로 자산을 이동하여 유동성을 유지하고 APR 수익을 극대화합니다.

## 개선할 점 및 추가 고려사항

- **에러 발생 시 재시도 로직**: 현재는 오류가 발생할 경우 로그를 출력하고 다음으로 넘어가지만, 중요 작업 (예: 주문 발행, 지갑 전송)에서 오류가 발생할 경우 재시도하는 로직을 추가하는 것이 안정성을 높이는 데 도움이 됩니다.
- **백업 데이터 사용 로직 강화**: 웹 소켓 오류 발생 시 REST API로 데이터를 백업할 수 있도록 하였는데, 이를 자동으로 전환하는 로직을 강화해 웹 소켓 재연결 시도 후에만 백업을 사용하도록 구현할 수 있습니다.
- **매수 및 매도 주문 체결 확인**: 주문이 체결되지 않은 경우 30초마다 주문을 취소하고 재발행하는 로직이 포함되어 있습니다. 그러나 이 경우 시장 상황에 따라 체결되지 않는 문제가 반복될 수 있습니다. 체결 가능성을 높이기 위해 추가적인 가격 조정이나 주문 조건 변경 등을 고려할 수 있습니다.
- **리스크 관리 및 테스트**: 전략을 실전에 도입하기 전, 리스크 관리 방안을 고려해야 합니다. 예를 들어, 백테스트 및 페이퍼 트레이딩을 통해 전략이 안정적인지 검증하는 것이 중요합니다.
- **API 호출 빈도 제한 관리**: Binance API는 호출 빈도 제한이 있기 때문에, 각 호출 간의 시간을 조절하여 Rate Limit을 초과하지 않도록 해야 합니다. 예를 들어, 현재 모니터링 스레드에서 데이터를 자주 조회하는 부분이 있으므로 호출 간격을 최적화하는 것이 중요합니다

## 기여 방법

프로젝트 개선을 위한 Pull Request는 언제든지 환영합니다. 코드 개선, 버그 수정 또는 새로운 기능 제안을 자유롭게 제출해 주세요.

## 라이선스

이 프로젝트는 MIT 라이선스 하에 제공됩니다.
